<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.21.2.final using JasperReports Library version 6.21.2-8434a0bd7c3bbc37cbf916f2968d35e4b165821a  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Lab_investigation_report" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="64a7418b-a86b-43e1-af1d-d034e8220358">
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="hims_db_uat"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<style name="Crosstab_CH" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.0" lineColor="#000000"/>
			<topPen lineWidth="0.0" lineColor="#000000"/>
			<leftPen lineWidth="0.0" lineColor="#000000"/>
			<bottomPen lineWidth="0.0" lineColor="#000000"/>
			<rightPen lineWidth="0.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CG" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.0" lineColor="#000000"/>
			<topPen lineWidth="0.0" lineColor="#000000"/>
			<leftPen lineWidth="0.0" lineColor="#000000"/>
			<bottomPen lineWidth="0.0" lineColor="#000000"/>
			<rightPen lineWidth="0.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CT" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.0" lineColor="#000000"/>
			<topPen lineWidth="0.0" lineColor="#000000"/>
			<leftPen lineWidth="0.0" lineColor="#000000"/>
			<bottomPen lineWidth="0.0" lineColor="#000000"/>
			<rightPen lineWidth="0.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.0" lineColor="#000000"/>
			<topPen lineWidth="0.0" lineColor="#000000"/>
			<leftPen lineWidth="0.0" lineColor="#000000"/>
			<bottomPen lineWidth="0.0" lineColor="#000000"/>
			<rightPen lineWidth="0.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_TH" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#FFFFFF"/>
			<topPen lineWidth="0.5" lineColor="#FFFFFF"/>
			<leftPen lineWidth="0.5" lineColor="#FFFFFF"/>
			<bottomPen lineWidth="0.5" lineColor="#FFFFFF"/>
			<rightPen lineWidth="0.5" lineColor="#FFFFFF"/>
		</box>
	</style>
	<style name="Table_CH" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#FFFFFF"/>
			<topPen lineWidth="0.5" lineColor="#FFFFFF"/>
			<leftPen lineWidth="0.5" lineColor="#FFFFFF"/>
			<bottomPen lineWidth="0.5" lineColor="#FFFFFF"/>
			<rightPen lineWidth="0.5" lineColor="#FFFFFF"/>
		</box>
	</style>
	<style name="Table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#FFFFFF"/>
			<topPen lineWidth="0.5" lineColor="#FFFFFF"/>
			<leftPen lineWidth="0.5" lineColor="#FFFFFF"/>
			<bottomPen lineWidth="0.5" lineColor="#FFFFFF"/>
			<rightPen lineWidth="0.5" lineColor="#FFFFFF"/>
		</box>
	</style>
	<subDataset name="units" uuid="d14b49e4-1dbb-4b3c-887c-64246afa458e">
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="hims_db"/>
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<parameter name="sub_chargecode_name" class="java.lang.String"/>
		<parameter name="investigation_sample" class="java.lang.String"/>
		<parameter name="orderhd_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[with selected_order as (
    select 
        doh.orderhd_id,
        doh.order_date,
        dreh.hin_id AS patient_id
    from dg_orderhd doh
    join dg_result_entry_header dreh on doh.orderhd_id = dreh.order_hd_id
    where doh.orderhd_id = $P{orderhd_id}
),
last_five_orders AS (
    select 
        doh.orderhd_id
    from dg_orderhd doh
    join dg_result_entry_header dreh on doh.orderhd_id = dreh.order_hd_id
    join selected_order so on dreh.hin_id = so.patient_id
    where doh.order_date <= so.order_date
    order by doh.order_date desc
    limit 5
)

select	
    msc.sub_chargecode_name,
    (dmi.investigation_name || ',' || dms.sample_description) as investigation_sample,
    case
        when dsmi.sub_investigation_name is null then dmi.investigation_name
        else dsmi.sub_investigation_name
    end as sub_investigation_name,
    mim.method_name,
    to_char(dsch.collection_time, 'DD/Mon/YY') as collection_date,
    to_char(dsch.collection_time, 'HH12:MIAM') as collection_time,
    dsch.collection_time as collection_ts,
    dred.result as result,
    du.uom_name as unit
from dg_result_entry_header dreh
left join dg_result_entry_detail dred on dreh.result_entry_id = dred.result_entry_id
left join dg_sample_collection_details dscd on dred.sample_collection_details_id = dscd.sample_collection_details_id
left join dg_sample_collection_header dsch on dscd.sample_collection_header_id = dsch.sample_collection_header_id
left join dg_mas_investigation dmi on dred.investigation_id = dmi.investigation_id
left join dg_sub_mas_investigation dsmi on dred.sub_investigation_id = dsmi.sub_investigation_id
left join dg_uom du on dred.uom_id = du.uom_id
left join mas_sub_chargecode msc on dreh.sub_chargecode_id = msc.sub_chargecode_id
left join dg_mas_sample dms on dscd.sample_id = dms.sample_id
left join mas_investigation_methodology mim on dmi.method_id = mim.method_id
where dreh.order_hd_id in (select orderhd_id from last_five_orders)
  and dred.validated = 'y' 
  and msc.sub_chargecode_name = $P{sub_chargecode_name}
  and (dmi.investigation_name || ',' || dms.sample_description) = $P{investigation_sample}
order by collection_ts;]]>
		</queryString>
		<field name="sub_chargecode_name" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="sub_chargecode_name"/>
			<property name="com.jaspersoft.studio.field.label" value="sub_chargecode_name"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="mas_sub_chargecode"/>
		</field>
		<field name="investigation_sample" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="investigation_sample"/>
			<property name="com.jaspersoft.studio.field.label" value="investigation_sample"/>
		</field>
		<field name="sub_investigation_name" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="sub_investigation_name"/>
			<property name="com.jaspersoft.studio.field.label" value="sub_investigation_name"/>
		</field>
		<field name="method_name" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="method_name"/>
			<property name="com.jaspersoft.studio.field.label" value="method_name"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="mas_investigation_methodology"/>
		</field>
		<field name="collection_date" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="collection_date"/>
			<property name="com.jaspersoft.studio.field.label" value="collection_date"/>
		</field>
		<field name="collection_time" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="collection_time"/>
			<property name="com.jaspersoft.studio.field.label" value="collection_time"/>
		</field>
		<field name="collection_ts" class="java.sql.Timestamp">
			<property name="com.jaspersoft.studio.field.name" value="collection_ts"/>
			<property name="com.jaspersoft.studio.field.label" value="collection_ts"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="dg_sample_collection_header"/>
		</field>
		<field name="result" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="result"/>
			<property name="com.jaspersoft.studio.field.label" value="result"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="dg_result_entry_detail"/>
		</field>
		<field name="unit" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="unit"/>
			<property name="com.jaspersoft.studio.field.label" value="unit"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="dg_uom"/>
		</field>
	</subDataset>
	<subDataset name="unit_bioref" uuid="85d61754-5d16-4223-ad8b-175ac5ca8372">
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="hims_db"/>
		<parameter name="sub_chargecode_name" class="java.lang.String"/>
		<parameter name="investigation_sample" class="java.lang.String"/>
		<parameter name="sub_investigation_name" class="java.lang.String"/>
		<parameter name="orderhd_id" class="java.lang.Integer"/>
		<queryString language="SQL">
			<![CDATA[with selected_order as (
    select 
        doh.orderhd_id,
        doh.order_date,
        dreh.hin_id AS patient_id
    from dg_orderhd doh
    join dg_result_entry_header dreh on doh.orderhd_id = dreh.order_hd_id
    where doh.orderhd_id = $P{orderhd_id}
),
last_five_orders AS (
    select 
        doh.orderhd_id
    from dg_orderhd doh
    join dg_result_entry_header dreh on doh.orderhd_id = dreh.order_hd_id
    join selected_order so on dreh.hin_id = so.patient_id
    where doh.order_date <= so.order_date
    order by doh.order_date desc
    limit 5
)

select distinct
    msc.sub_chargecode_name,
    (dmi.investigation_name || ',' || dms.sample_description) as investigation_sample,
    case
        when dsmi.sub_investigation_name is null then dmi.investigation_name
        else dsmi.sub_investigation_name
    end as sub_investigation_name,
    du.uom_name as unit,
    dred.normal_range::text as bio_ref
from dg_result_entry_header dreh
left join dg_result_entry_detail dred on dreh.result_entry_id = dred.result_entry_id
left join dg_sample_collection_details dscd on dred.sample_collection_details_id = dscd.sample_collection_details_id
left join dg_sample_collection_header dsch on dscd.sample_collection_header_id = dsch.sample_collection_header_id
left join dg_mas_investigation dmi on dred.investigation_id = dmi.investigation_id
left join dg_sub_mas_investigation dsmi on dred.sub_investigation_id = dsmi.sub_investigation_id
left join dg_uom du on dred.uom_id = du.uom_id
left join mas_sub_chargecode msc on dreh.sub_chargecode_id = msc.sub_chargecode_id
left join dg_mas_sample dms on dscd.sample_id = dms.sample_id
where dreh.order_hd_id in (select orderhd_id from last_five_orders)
  and dred.validated = 'y'
  and msc.sub_chargecode_name = $P{sub_chargecode_name}
  and (dmi.investigation_name || ',' || dms.sample_description) = $P{investigation_sample}
  and (
        case
            when dsmi.sub_investigation_name is null then dmi.investigation_name
            else dsmi.sub_investigation_name
        end
      ) = $P{sub_investigation_name};]]>
		</queryString>
		<field name="sub_chargecode_name" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="sub_chargecode_name"/>
			<property name="com.jaspersoft.studio.field.label" value="sub_chargecode_name"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="mas_sub_chargecode"/>
		</field>
		<field name="investigation_sample" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="investigation_sample"/>
			<property name="com.jaspersoft.studio.field.label" value="investigation_sample"/>
		</field>
		<field name="sub_investigation_name" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="sub_investigation_name"/>
			<property name="com.jaspersoft.studio.field.label" value="sub_investigation_name"/>
		</field>
		<field name="unit" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="unit"/>
			<property name="com.jaspersoft.studio.field.label" value="unit"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="dg_uom"/>
		</field>
		<field name="bio_ref" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="bio_ref"/>
			<property name="com.jaspersoft.studio.field.label" value="bio_ref"/>
		</field>
	</subDataset>
	<parameter name="orderhd_id" class="java.lang.Integer"/>
	<queryString>
		<![CDATA[with selected_order as (
    select 
        doh.orderhd_id,
        doh.order_date,
        dreh.hin_id AS patient_id
    from dg_orderhd doh
	join dg_result_entry_header dreh on doh.orderhd_id = dreh.order_hd_id
    where orderhd_id = $P{orderhd_id}
),
last_five_orders AS (
    select 
        doh.orderhd_id
    from dg_orderhd doh
	join dg_result_entry_header dreh on doh.orderhd_id = dreh.order_hd_id
    join selected_order so on dreh.hin_id = so.patient_id
    where doh.order_date <= so.order_date
    order by doh.order_date desc
    limit 5
)
select distinct
    dreh.order_hd_id,
    doh.order_date,
    dreh.hin_id,
    case
        when p.p_mn is NULL or p.p_mn = '' 
            then CONCAT(p_fn, ' ', p_ln)
        else CONCAT(p.p_fn, ' ', p.p_mn, ' ', p.p_ln)
    end as patient_name,
    CONCAT(p_age, '/', mg.gender_code) as age_gender,
    mr.relation_name as ref_doctor,
    mh.address as centre,
    p.uhid_no as uhid,
    to_char(dsch.collection_time, 'DD/Mon/YY HH12:MIAM') as collection_datetime,
    to_char((result_date::date + result_time::time), 'DD/Mon/YY HH12:MIAM') AS result_datetime,

    msc.sub_chargecode_name,
    dmi.investigation_name || ',' || dms.sample_description AS investigation_sample,
    case
        when dsmi.sub_investigation_name is NULL 
            then dmi.investigation_name
        else dsmi.sub_investigation_name
    end as sub_investigation_name,
    case
        when dmi.interpretation is NULL 
            then 'No interpretations available at the moment'
        else dmi.interpretation
    end AS interpretation

from dg_result_entry_header dreh
left join dg_result_entry_detail dred on dreh.result_entry_id = dred.result_entry_id
left join dg_sample_collection_details dscd on dred.sample_collection_details_id = dscd.sample_collection_details_id
left join dg_sample_collection_header dsch on dscd.sample_collection_header_id = dsch.sample_collection_header_id
left join dg_mas_investigation dmi on dred.investigation_id = dmi.investigation_id
left join dg_sub_mas_investigation dsmi on dred.sub_investigation_id = dsmi.sub_investigation_id
left join mas_sub_chargecode msc on dreh.sub_chargecode_id = msc.sub_chargecode_id
left join dg_mas_sample dms on dscd.sample_id = dms.sample_id
left join patient p on dreh.hin_id = p.patient_id
left join mas_gender mg on p.p_gender_id = mg.id
left join mas_relation mr on p.p_relation_id = mr.relation_id
left join mas_hospital mh on dreh.hospital_id = mh.hospital_id
left join dg_orderhd doh on dreh.order_hd_id = doh.orderhd_id
where dreh.order_hd_id in (select orderhd_id from last_five_orders) and dred.validated = 'y'
order by msc.sub_chargecode_name, investigation_sample, sub_investigation_name;]]>
	</queryString>
	<field name="order_hd_id" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.name" value="order_hd_id"/>
		<property name="com.jaspersoft.studio.field.label" value="order_hd_id"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="dg_result_entry_header"/>
	</field>
	<field name="order_date" class="java.sql.Date">
		<property name="com.jaspersoft.studio.field.name" value="order_date"/>
		<property name="com.jaspersoft.studio.field.label" value="order_date"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="dg_orderhd"/>
	</field>
	<field name="hin_id" class="java.lang.Long">
		<property name="com.jaspersoft.studio.field.name" value="hin_id"/>
		<property name="com.jaspersoft.studio.field.label" value="hin_id"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="dg_result_entry_header"/>
	</field>
	<field name="patient_name" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="patient_name"/>
		<property name="com.jaspersoft.studio.field.label" value="patient_name"/>
	</field>
	<field name="age_gender" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="age_gender"/>
		<property name="com.jaspersoft.studio.field.label" value="age_gender"/>
	</field>
	<field name="ref_doctor" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="ref_doctor"/>
		<property name="com.jaspersoft.studio.field.label" value="ref_doctor"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="mas_relation"/>
	</field>
	<field name="centre" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="centre"/>
		<property name="com.jaspersoft.studio.field.label" value="centre"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="mas_hospital"/>
	</field>
	<field name="uhid" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="uhid"/>
		<property name="com.jaspersoft.studio.field.label" value="uhid"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="patient"/>
	</field>
	<field name="collection_datetime" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="collection_datetime"/>
		<property name="com.jaspersoft.studio.field.label" value="collection_datetime"/>
	</field>
	<field name="result_datetime" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="result_datetime"/>
		<property name="com.jaspersoft.studio.field.label" value="result_datetime"/>
	</field>
	<field name="sub_chargecode_name" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="sub_chargecode_name"/>
		<property name="com.jaspersoft.studio.field.label" value="sub_chargecode_name"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="mas_sub_chargecode"/>
	</field>
	<field name="investigation_sample" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="investigation_sample"/>
		<property name="com.jaspersoft.studio.field.label" value="investigation_sample"/>
	</field>
	<field name="sub_investigation_name" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="sub_investigation_name"/>
		<property name="com.jaspersoft.studio.field.label" value="sub_investigation_name"/>
	</field>
	<field name="interpretation" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="interpretation"/>
		<property name="com.jaspersoft.studio.field.label" value="interpretation"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="dg_mas_investigation"/>
	</field>
	<group name="g_sub_chargecode_name" isStartNewPage="true" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{sub_chargecode_name}]]></groupExpression>
		<groupHeader>
			<band height="26">
				<textField>
					<reportElement x="0" y="6" width="555" height="19" uuid="5d85d2ee-a210-439c-a7f1-481d4cf09ad5"/>
					<textElement textAlignment="Center">
						<font size="10" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{sub_chargecode_name}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="72">
				<staticText>
					<reportElement x="0" y="35" width="555" height="30" uuid="9774f9bc-14bb-4eb3-97df-420d31c61b53"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font size="10" isBold="true"/>
					</textElement>
					<text><![CDATA[***End of Report***]]></text>
				</staticText>
				<line>
					<reportElement x="0" y="32" width="555" height="1" uuid="48a004f9-b3ad-4a9c-a591-0bf72c2db47e"/>
				</line>
				<staticText>
					<reportElement x="10" y="2" width="230" height="31" uuid="4235a4da-eeeb-44e2-b28e-9b6510b3af7d"/>
					<textElement verticalAlignment="Middle">
						<font size="10"/>
					</textElement>
					<text><![CDATA[Kindly correlate with clinical findings]]></text>
				</staticText>
			</band>
		</groupFooter>
	</group>
	<group name="g_investigation_sample">
		<groupExpression><![CDATA[$F{investigation_sample}]]></groupExpression>
		<groupHeader>
			<band height="96">
				<textField>
					<reportElement isPrintRepeatedValues="false" x="0" y="13" width="555" height="20" uuid="8b2a4425-c9d9-47e6-b3c5-341657c12d69"/>
					<textElement textAlignment="Left" verticalAlignment="Top">
						<font size="10" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{investigation_sample}]]></textFieldExpression>
				</textField>
				<crosstab>
					<reportElement isPrintRepeatedValues="false" x="10" y="33" width="420" height="60" uuid="c5ba8d82-8cd0-450b-8e08-3426f804081d">
						<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.VerticalRowLayout"/>
						<property name="com.jaspersoft.studio.crosstab.style.header" value="Crosstab_CH"/>
						<property name="com.jaspersoft.studio.crosstab.style.group" value="Crosstab_CG"/>
						<property name="com.jaspersoft.studio.crosstab.style.total" value="Crosstab_CT"/>
						<property name="com.jaspersoft.studio.crosstab.style.detail" value="Crosstab_CD"/>
					</reportElement>
					<crosstabDataset>
						<dataset>
							<datasetRun subDataset="units" uuid="3312baba-6494-40ab-8c0c-54909bfbeeee">
								<datasetParameter name="sub_chargecode_name">
									<datasetParameterExpression><![CDATA[$F{sub_chargecode_name}]]></datasetParameterExpression>
								</datasetParameter>
								<datasetParameter name="investigation_sample">
									<datasetParameterExpression><![CDATA[$F{investigation_sample}]]></datasetParameterExpression>
								</datasetParameter>
								<datasetParameter name="orderhd_id">
									<datasetParameterExpression><![CDATA[$P{orderhd_id}]]></datasetParameterExpression>
								</datasetParameter>
								<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
							</datasetRun>
						</dataset>
					</crosstabDataset>
					<crosstabHeaderCell>
						<cellContents mode="Opaque" style="Crosstab_CD">
							<staticText>
								<reportElement x="0" y="0" width="100" height="40" uuid="54802eb7-7ed3-4779-9551-2c4b898d7de8"/>
								<textElement textAlignment="Left" verticalAlignment="Middle">
									<font size="10" isBold="true"/>
								</textElement>
								<text><![CDATA[Date]]></text>
							</staticText>
						</cellContents>
					</crosstabHeaderCell>
					<rowGroup name="sub_investigation_name" width="100">
						<bucket class="java.lang.Object">
							<bucketExpression><![CDATA["<span style='font-size:8px;'>"
+ $F{sub_investigation_name}
+ "</span>"
+ "<br/>"
+ "<span style='font-size:6px; color:#777;'>"
+ ($F{method_name} == null ? "" : $F{method_name})
+ "</span>"]]></bucketExpression>
						</bucket>
						<crosstabRowHeader>
							<cellContents mode="Opaque" style="Crosstab_CH">
								<textField>
									<reportElement x="0" y="0" width="100" height="30" uuid="4b611b8f-d8bc-4d2f-a96e-7862bc434ca1"/>
									<textElement markup="html"/>
									<textFieldExpression><![CDATA[$V{sub_investigation_name}]]></textFieldExpression>
								</textField>
							</cellContents>
						</crosstabRowHeader>
						<crosstabTotalRowHeader>
							<cellContents mode="Opaque" style="Crosstab_CT">
								<staticText>
									<reportElement x="0" y="0" width="60" height="20" uuid="16c821de-c57b-4a7c-8731-1be235a8eadc"/>
									<text><![CDATA[Total sub_investigation_name]]></text>
								</staticText>
							</cellContents>
						</crosstabTotalRowHeader>
					</rowGroup>
					<columnGroup name="collection_date" height="20">
						<bucket order="Descending" class="java.lang.String">
							<bucketExpression><![CDATA[$F{collection_date}]]></bucketExpression>
						</bucket>
						<crosstabColumnHeader>
							<cellContents mode="Opaque" style="Crosstab_CH">
								<textField>
									<reportElement x="0" y="0" width="60" height="20" uuid="5785db88-f8aa-4ed5-b555-37624a4eea11"/>
									<textElement>
										<font size="10" isBold="true"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{collection_date}]]></textFieldExpression>
								</textField>
							</cellContents>
						</crosstabColumnHeader>
						<crosstabTotalColumnHeader>
							<cellContents>
								<staticText>
									<reportElement x="0" y="0" width="0" height="0" uuid="a5faa49a-572b-42ac-a366-66aed50554d9"/>
									<text><![CDATA[Total collection_date]]></text>
								</staticText>
							</cellContents>
						</crosstabTotalColumnHeader>
					</columnGroup>
					<columnGroup name="collection_time" height="20">
						<bucket order="Descending" class="java.lang.String">
							<bucketExpression><![CDATA[$F{collection_time}]]></bucketExpression>
						</bucket>
						<crosstabColumnHeader>
							<cellContents mode="Opaque" style="Crosstab_CH">
								<textField>
									<reportElement x="0" y="0" width="60" height="20" uuid="0dd6c65f-b2f7-4714-911c-c9d046a3b7fa"/>
									<textElement>
										<font size="10" isBold="true"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{collection_time}]]></textFieldExpression>
								</textField>
							</cellContents>
						</crosstabColumnHeader>
						<crosstabTotalColumnHeader>
							<cellContents>
								<staticText>
									<reportElement x="0" y="0" width="0" height="0" uuid="c2d1994b-b4c8-4448-895d-ed41e56a466e"/>
									<text><![CDATA[Total collection_time]]></text>
								</staticText>
							</cellContents>
						</crosstabTotalColumnHeader>
					</columnGroup>
					<measure name="result_MEASURE" class="java.lang.String">
						<measureExpression><![CDATA[$F{result}]]></measureExpression>
					</measure>
					<crosstabCell width="60" height="30">
						<cellContents mode="Opaque" style="Crosstab_CD">
							<textField>
								<reportElement x="0" y="0" width="60" height="30" uuid="a0e1aac9-9e2a-4f5b-a7b1-99c09783faa1"/>
								<textElement>
									<font size="10"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{result_MEASURE}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabCell>
					<crosstabCell width="60" height="20" columnTotalGroup="collection_date">
						<cellContents mode="Opaque" style="Crosstab_CT">
							<textField>
								<reportElement x="0" y="0" width="60" height="20" uuid="aafb0e8b-992d-43a6-a0e8-6bbb4c7ad03d"/>
								<textFieldExpression><![CDATA[$V{result_MEASURE}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabCell>
					<crosstabCell width="60" height="20" columnTotalGroup="collection_time">
						<cellContents mode="Opaque" style="Crosstab_CG">
							<textField>
								<reportElement x="0" y="0" width="60" height="20" uuid="b4b0e1a9-2bf7-499f-b3c6-4f19c6eb712f"/>
								<textFieldExpression><![CDATA[$V{result_MEASURE}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabCell>
					<crosstabCell width="60" height="20" rowTotalGroup="sub_investigation_name">
						<cellContents mode="Opaque" style="Crosstab_CT"/>
					</crosstabCell>
					<crosstabCell width="60" height="20" rowTotalGroup="sub_investigation_name" columnTotalGroup="collection_date">
						<cellContents mode="Opaque" style="Crosstab_CT"/>
					</crosstabCell>
					<crosstabCell width="60" height="20" rowTotalGroup="sub_investigation_name" columnTotalGroup="collection_time">
						<cellContents mode="Opaque" style="Crosstab_CT"/>
					</crosstabCell>
				</crosstab>
				<componentElement>
					<reportElement isPrintRepeatedValues="false" x="430" y="43" width="124" height="48" uuid="4c787a69-03fe-4f32-b509-76f7db761570">
						<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.VerticalRowLayout"/>
						<property name="com.jaspersoft.studio.table.style.table_header" value="Table_TH"/>
						<property name="com.jaspersoft.studio.table.style.column_header" value="Table_CH"/>
						<property name="com.jaspersoft.studio.table.style.detail" value="Table_TD"/>
					</reportElement>
					<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
						<datasetRun subDataset="unit_bioref" uuid="a3eebea1-5baf-43ef-9ec3-fea6ebd282d2">
							<datasetParameter name="sub_chargecode_name">
								<datasetParameterExpression><![CDATA[$F{sub_chargecode_name}]]></datasetParameterExpression>
							</datasetParameter>
							<datasetParameter name="investigation_sample">
								<datasetParameterExpression><![CDATA[$F{investigation_sample}]]></datasetParameterExpression>
							</datasetParameter>
							<datasetParameter name="sub_investigation_name">
								<datasetParameterExpression><![CDATA[$F{sub_investigation_name}]]></datasetParameterExpression>
							</datasetParameter>
							<datasetParameter name="orderhd_id">
								<datasetParameterExpression><![CDATA[$P{orderhd_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:column width="40" uuid="62b92b92-97aa-4920-ba1e-b81198280af8">
							<jr:columnHeader style="Table_CH" height="30">
								<staticText>
									<reportElement x="0" y="0" width="40" height="30" uuid="d7f2773a-b700-418f-8b94-5f4d5a0e4c8b"/>
									<textElement verticalAlignment="Middle">
										<font size="10" isBold="true"/>
									</textElement>
									<text><![CDATA[unit]]></text>
								</staticText>
							</jr:columnHeader>
							<jr:detailCell style="Table_TD" height="30">
								<textField>
									<reportElement x="0" y="0" width="40" height="30" uuid="222555a6-553c-4082-84eb-be75277dd497"/>
									<textElement>
										<font size="10"/>
									</textElement>
									<textFieldExpression><![CDATA[$F{unit}]]></textFieldExpression>
								</textField>
							</jr:detailCell>
						</jr:column>
						<jr:column width="100" uuid="46b4531c-8dd5-49d1-b819-d3e98863662f">
							<jr:columnHeader style="Table_CH" height="30">
								<staticText>
									<reportElement x="0" y="0" width="100" height="30" uuid="72517b04-2a50-4477-84e1-95890da1a6ef"/>
									<textElement verticalAlignment="Middle">
										<font size="10" isBold="true"/>
									</textElement>
									<text><![CDATA[Bio Ref Interval]]></text>
								</staticText>
							</jr:columnHeader>
							<jr:detailCell style="Table_TD" height="30">
								<textField>
									<reportElement x="0" y="0" width="100" height="30" uuid="9a6d6b60-85bc-4e60-8a72-253032de25e3"/>
									<textElement>
										<font size="10"/>
									</textElement>
									<textFieldExpression><![CDATA[$F{bio_ref}]]></textFieldExpression>
								</textField>
							</jr:detailCell>
						</jr:column>
					</jr:table>
				</componentElement>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="57">
				<textField>
					<reportElement x="10" y="20" width="545" height="30" uuid="b45e1e04-b986-4493-997e-ff854d4f5189"/>
					<textElement verticalAlignment="Middle">
						<font size="10"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{interpretation}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="0" y="0" width="555" height="20" printWhenGroupChanges="g_investigation_sample" uuid="f3ceeee8-93c2-4c97-8f1d-357a6ed7c902"/>
					<textElement textAlignment="Left" verticalAlignment="Middle">
						<font size="11" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["Interpretation"]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="140">
			<rectangle>
				<reportElement mode="Transparent" x="0" y="40" width="555" height="100" uuid="175c0d11-d40e-4486-a9cc-0614c9bb4e8a"/>
			</rectangle>
			<staticText>
				<reportElement x="10" y="50" width="90" height="20" uuid="6d2bf3ab-8173-4e6f-baf9-b36c4509ebc2"/>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<text><![CDATA[Patient Name]]></text>
			</staticText>
			<staticText>
				<reportElement x="10" y="70" width="90" height="20" uuid="734d5d6e-a349-4e1e-ad86-7843330c6843"/>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<text><![CDATA[Age/Gender]]></text>
			</staticText>
			<staticText>
				<reportElement x="10" y="90" width="90" height="20" uuid="fc839eed-d64d-4c99-9d3e-d6b849821a07"/>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<text><![CDATA[PID/Lab ID]]></text>
			</staticText>
			<staticText>
				<reportElement x="10" y="110" width="90" height="20" uuid="9a8f8a06-e2fb-4b73-a6bb-bf8f96f0c0c1"/>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<text><![CDATA[Ref Doctor]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="8" width="555" height="30" uuid="f35f9bc4-5c64-4c4c-81a6-f55807937226"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<text><![CDATA[Laboratory Investigation Report]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="50" width="10" height="20" uuid="aaf5c6e3-7099-40a9-b52f-8099b9823632"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="70" width="10" height="20" uuid="9e2f7fdb-91c2-476f-b225-1388358eec83"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="90" width="10" height="20" uuid="a6b3786a-878a-4f72-91d7-05afa552188e"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="110" width="10" height="20" uuid="cf54ad47-6940-445c-9167-61be2594dc40"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<staticText>
				<reportElement x="240" y="50" width="140" height="20" uuid="adac1aac-a259-419c-9bb1-7fd4c9e40d6d"/>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<text><![CDATA[Centre]]></text>
			</staticText>
			<staticText>
				<reportElement x="240" y="70" width="140" height="20" uuid="cfa08d4a-6d6f-4b86-adaf-92ba56639d8a"/>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<text><![CDATA[OP/IP No/UHID]]></text>
			</staticText>
			<staticText>
				<reportElement x="240" y="90" width="140" height="20" uuid="3dea8686-b6fc-40d2-beca-d29496c6405c"/>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<text><![CDATA[Collection Date/Time]]></text>
			</staticText>
			<staticText>
				<reportElement x="240" y="110" width="140" height="20" uuid="ad90f4f7-d4ff-4b45-b11e-06ecf70759ec"/>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<text><![CDATA[Reporting Date/Time]]></text>
			</staticText>
			<staticText>
				<reportElement x="380" y="50" width="10" height="20" uuid="6c3365ad-63e8-4c1a-942d-a51c27cea52d"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<staticText>
				<reportElement x="380" y="110" width="10" height="20" uuid="ca137a45-b124-459f-8092-3b5bf3352a3d"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<staticText>
				<reportElement x="380" y="90" width="10" height="20" uuid="d3357b19-a88f-491b-9c84-662ee8edf875"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<staticText>
				<reportElement x="380" y="70" width="10" height="20" uuid="1f38819d-a387-4eec-933c-e7b1f4b3842e"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<textField>
				<reportElement x="110" y="50" width="120" height="20" uuid="e02bf2e1-9566-4676-9091-b86721793e01"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{patient_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="110" y="70" width="120" height="20" uuid="c09fd32c-c114-4619-9f75-8e825778f582"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{age_gender}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="110" y="90" width="120" height="20" uuid="41d03b14-fe74-4507-8900-9778931b95cd"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{order_hd_id}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="110" y="110" width="120" height="20" uuid="000ecde1-cd82-41a6-8e6e-d6e41797fa18"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ref_doctor}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="390" y="50" width="155" height="20" uuid="d3ff61ae-b44b-444e-b6f0-744223cdd133"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{centre}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="390" y="70" width="155" height="20" uuid="87e7298e-5c7c-4ed6-a377-e1ba60f75761"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{uhid}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="390" y="90" width="155" height="20" uuid="cda92c15-3aff-4460-8759-8aed915fd69b"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{collection_datetime}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="390" y="110" width="155" height="20" uuid="e03d4012-61a1-4482-875d-c504f5b2e5ff"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{result_datetime}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
</jasperReport>
